<!-- This file is @generated by `cargo run -p bastion --bin docgen -- --write` -->
<!-- Do not edit manually. -->

## bastion

```text
Bastion backup server (MVP)

Usage: bastion [OPTIONS] [COMMAND]

Commands:
  agent    Run a Bastion Agent and connect it to a Hub
  keypack  Manage secrets keypacks in the Hub data directory

Options:
      --log <LOG>
          Logging filter (same syntax as RUST_LOG), e.g. `info`, `bastion=debug,tower_http=warn`.
          
          When not set, Bastion defaults to a conservative `info,tower_http=warn` filter.
          
          [env: BASTION_LOG=]

      --log-file <LOG_FILE>
          Optional log file path. When set, logs are written to both console and file.
          
          For rotated logs, Bastion uses the file name as a prefix (e.g. `bastion.log.2025-12-31`).
          
          [env: BASTION_LOG_FILE=]

      --log-rotation <LOG_ROTATION>
          Log rotation for `--log-file` (default: daily)
          
          [env: BASTION_LOG_ROTATION=]
          [default: daily]
          [possible values: never, hourly, daily]

      --log-keep-files <LOG_KEEP_FILES>
          How many rotated log files to keep (default: 30, 0 disables pruning)
          
          [env: BASTION_LOG_KEEP_FILES=]
          [default: 30]

      --host <HOST>
          Bind host (default: 127.0.0.1)
          
          [env: BASTION_HOST=]
          [default: 127.0.0.1]

      --port <PORT>
          Bind port (default: 9876)
          
          [env: BASTION_PORT=]
          [default: 9876]

      --data-dir <DATA_DIR>
          Override the data directory (also supports BASTION_DATA_DIR)
          
          [env: BASTION_DATA_DIR=]

      --insecure-http
          Explicitly allow insecure HTTP/WS mode (dev/LAN only)
          
          [env: BASTION_INSECURE_HTTP=]

      --debug-errors
          Include debug-only error diagnostics in API responses (dev only).
          
          When enabled, HTTP 500 `internal_error` responses may include safe diagnostics in `details.debug`.
          
          [env: BASTION_DEBUG_ERRORS=]

      --run-retention-days <RUN_RETENTION_DAYS>
          Run history retention in days (default: 180)
          
          [env: BASTION_RUN_RETENTION_DAYS=]
          [default: 180]

      --incomplete-cleanup-days <INCOMPLETE_CLEANUP_DAYS>
          Cleanup incomplete runs (missing complete.json) older than N days (default: 7, 0 disables)
          
          [env: BASTION_INCOMPLETE_CLEANUP_DAYS=]
          [default: 7]

      --hub-timezone <HUB_TIMEZONE>
          Hub timezone (IANA), used as the default schedule timezone (default: local system timezone).
          
          Examples: `UTC`, `Asia/Shanghai`, `America/Los_Angeles`.
          
          [env: BASTION_HUB_TIMEZONE=]

      --trusted-proxy [<TRUSTED_PROXIES>...]
          Trusted proxy IPs/CIDRs that are allowed to set X-Forwarded-* headers.
          
          Can be specified multiple times: `--trusted-proxy 127.0.0.1/32 --trusted-proxy ::1/128`.
          
          [env: BASTION_TRUSTED_PROXIES=]

  -h, --help
          Print help (see a summary with '-h')

  -V, --version
          Print version
```

## bastion agent

```text
Run a Bastion Agent and connect it to a Hub

Usage: bastion agent [OPTIONS] --hub-url <HUB_URL>

Options:
      --hub-url <HUB_URL>
          Hub base URL, e.g. `http://hub:9876` or `https://hub.example.com`
          
          [env: BASTION_HUB_URL=]

      --enroll-token <ENROLL_TOKEN>
          Enrollment token (only required when the agent is not enrolled yet)
          
          [env: BASTION_AGENT_ENROLL_TOKEN=]

      --name <NAME>
          Friendly agent name (stored on the Hub, optional)
          
          [env: BASTION_AGENT_NAME=]

      --data-dir <DATA_DIR>
          Override the data directory (also supports BASTION_DATA_DIR)
          
          [env: BASTION_DATA_DIR=]

      --heartbeat-seconds <HEARTBEAT_SECONDS>
          Heartbeat interval in seconds (default: 15)
          
          [env: BASTION_AGENT_HEARTBEAT_SECONDS=]
          [default: 15]

  -h, --help
          Print help
```

## bastion keypack

```text
Manage secrets keypacks in the Hub data directory

Usage: bastion keypack <COMMAND>

Commands:
  export  Export a password-encrypted keypack
  import  Import a password-encrypted keypack
  rotate  Rotate the Hub master key (master.key)

Options:
  -h, --help
          Print help
```

## bastion keypack export

```text
Export a password-encrypted keypack

Usage: bastion keypack export [OPTIONS] --out <OUT>

Options:
      --out <OUT>
          Output path for the password-encrypted keypack

      --password <PASSWORD>
          Keypack password (not recommended to pass via CLI args; prefer --password-stdin)
          
          [env: BASTION_KEYPACK_PASSWORD]

      --password-stdin
          Read the keypack password from stdin (trailing newline is trimmed)

  -h, --help
          Print help
```

## bastion keypack import

```text
Import a password-encrypted keypack

Usage: bastion keypack import [OPTIONS] --in <IN>

Options:
      --in <IN>
          Input path of the password-encrypted keypack

      --force
          Overwrite existing data_dir/master.key

      --password <PASSWORD>
          Keypack password (not recommended to pass via CLI args; prefer --password-stdin)
          
          [env: BASTION_KEYPACK_PASSWORD]

      --password-stdin
          Read the keypack password from stdin (trailing newline is trimmed)

  -h, --help
          Print help
```

## bastion keypack rotate

```text
Rotate the Hub master key (master.key)

Usage: bastion keypack rotate

Options:
  -h, --help
          Print help
```

