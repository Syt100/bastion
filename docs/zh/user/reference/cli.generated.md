<!-- This file is @generated by `cargo run -p bastion --bin docgen -- --write` -->
<!-- Do not edit manually. -->

## bastion

```text
Bastion 备份服务器（MVP）

用法: bastion [OPTIONS] [COMMAND]

选项:
      --log <LOG>
          日志过滤器（语法与 RUST_LOG 相同），例如 `info`、`bastion=debug,tower_http=warn`。
          
          未设置时，Bastion 默认使用较保守的 `info,tower_http=warn` 过滤器。
          
          [env: BASTION_LOG=]

      --log-file <LOG_FILE>
          可选的日志文件路径。设置后，日志会同时写入控制台和文件。
          
          对于轮转日志，Bastion 使用文件名作为前缀（例如 `bastion.log.2025-12-31`）。
          
          [env: BASTION_LOG_FILE=]

      --log-rotation <LOG_ROTATION>
          `--log-file` 的日志轮转策略（默认：daily）。
          
          [env: BASTION_LOG_ROTATION=]
          [default: daily]
          [possible values: never, hourly, daily]

      --log-keep-files <LOG_KEEP_FILES>
          保留多少个轮转日志文件（默认：30，0 表示不清理）。
          
          [env: BASTION_LOG_KEEP_FILES=]
          [default: 30]

      --host <HOST>
          绑定地址（默认：127.0.0.1）。
          
          [env: BASTION_HOST=]
          [default: 127.0.0.1]

      --port <PORT>
          绑定端口（默认：9876）。
          
          [env: BASTION_PORT=]
          [default: 9876]

      --data-dir <DATA_DIR>
          覆盖数据目录（也支持 BASTION_DATA_DIR）。
          
          [env: BASTION_DATA_DIR=]

      --insecure-http
          显式允许不安全的 HTTP/WS 模式（仅开发/局域网）。
          
          [env: BASTION_INSECURE_HTTP=]

      --debug-errors
          在 API 响应中包含仅用于调试的错误诊断信息（仅开发环境）。
          
          启用后，HTTP 500 `internal_error` 响应可能会在 `details.debug` 中包含安全的诊断信息。
          
          [env: BASTION_DEBUG_ERRORS=]

      --run-retention-days <RUN_RETENTION_DAYS>
          运行记录保留天数（默认：180）。
          
          [env: BASTION_RUN_RETENTION_DAYS=]
          [default: 180]

      --incomplete-cleanup-days <INCOMPLETE_CLEANUP_DAYS>
          清理超过 N 天的未完成运行（缺少 complete.json）（默认：7，0 表示禁用）。
          
          [env: BASTION_INCOMPLETE_CLEANUP_DAYS=]
          [default: 7]

      --hub-timezone <HUB_TIMEZONE>
          Hub 时区（IANA），用作默认的计划任务时区（默认：本机系统时区）。
          
          示例：`UTC`、`Asia/Shanghai`、`America/Los_Angeles`。
          
          [env: BASTION_HUB_TIMEZONE=]

      --trusted-proxy [<TRUSTED_PROXIES>...]
          允许设置 X-Forwarded-* 头的受信任代理 IP/CIDR。
          
          可多次指定：`--trusted-proxy 127.0.0.1/32 --trusted-proxy ::1/128`。
          
          [env: BASTION_TRUSTED_PROXIES=]

  -h, --help
          Print help (see a summary with '-h')

  -V, --version
          Print version

命令:
  agent    运行 Bastion Agent 并连接到 Hub。
  config   查看 Hub 生效配置（值与来源）。
  doctor   运行常见部署问题的诊断。
  keypack  管理 Hub 数据目录中的 secrets keypack。
```

## bastion agent

```text
运行 Bastion Agent 并连接到 Hub。

用法: bastion agent [OPTIONS] --hub-url <HUB_URL>

选项:
      --hub-url <HUB_URL>
          Hub 基础 URL，例如 `http://hub:9876` 或 `https://hub.example.com`。
          
          [env: BASTION_HUB_URL=]

      --enroll-token <ENROLL_TOKEN>
          注册令牌（仅当 Agent 尚未加入 Hub 时需要）。
          
          [env: BASTION_AGENT_ENROLL_TOKEN=]

      --name <NAME>
          友好的 Agent 名称（存储在 Hub 上，可选）。
          
          [env: BASTION_AGENT_NAME=]

      --data-dir <DATA_DIR>
          覆盖数据目录（也支持 BASTION_DATA_DIR）。
          
          [env: BASTION_DATA_DIR=]

      --heartbeat-seconds <HEARTBEAT_SECONDS>
          心跳间隔（秒，默认：15）。
          
          [env: BASTION_AGENT_HEARTBEAT_SECONDS=]
          [default: 15]

  -h, --help
          Print help (see a summary with '-h')
```

## bastion config

```text
查看 Hub 生效配置（值与来源）。

用法: bastion config [OPTIONS]

选项:
      --json
          输出 JSON（便于脚本/CI 使用）。

  -h, --help
          Print help (see a summary with '-h')
```

## bastion doctor

```text
运行常见部署问题的诊断。

用法: bastion doctor [OPTIONS]

选项:
      --json
          输出 JSON（便于脚本/CI 使用）。

  -h, --help
          Print help (see a summary with '-h')
```

## bastion keypack

```text
管理 Hub 数据目录中的 secrets keypack。

用法: bastion keypack <COMMAND>

命令:
  export  导出密码加密的 keypack。
  import  导入密码加密的 keypack。
  rotate  轮转 Hub 主密钥（master.key）。
```

## bastion keypack export

```text
导出密码加密的 keypack。

用法: bastion keypack export [OPTIONS] --out <OUT>

选项:
      --out <OUT>
          密码加密 keypack 的输出路径。

      --password <PASSWORD>
          Keypack 密码（不建议通过命令行参数传入；优先使用 --password-stdin）。
          
          [env: BASTION_KEYPACK_PASSWORD]

      --password-stdin
          从 stdin 读取 keypack 密码（会去除末尾换行）。

  -h, --help
          Print help (see a summary with '-h')
```

## bastion keypack import

```text
导入密码加密的 keypack。

用法: bastion keypack import [OPTIONS] --in <IN>

选项:
      --in <IN>
          密码加密 keypack 的输入路径。

      --force
          覆盖现有的 data_dir/master.key。

      --password <PASSWORD>
          Keypack 密码（不建议通过命令行参数传入；优先使用 --password-stdin）。
          
          [env: BASTION_KEYPACK_PASSWORD]

      --password-stdin
          从 stdin 读取 keypack 密码（会去除末尾换行）。

  -h, --help
          Print help (see a summary with '-h')
```

## bastion keypack rotate

```text
轮转 Hub 主密钥（master.key）。

用法: bastion keypack rotate
```

